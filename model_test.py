from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, classification_report  
import joblib  
import logging
import numpy as np  
  
if __name__ == '__main__':
    logging.basicConfig(filename='./log/train.txt',  
                    level=logging.INFO,  
                    format='%(asctime)s - %(levelname)s - %(message)s')
    logging.info(f"\n----------------------------------start testing----------------------------------------------")
    X_test = np.load('./realworld/realworld_feature.npy')  
    y_test = np.load('./realworld/realworld_label.npy')  
    

    model_path = './model/androzoo_rf.pkl'  
    rf_model = joblib.load(model_path)  

    y_pred = rf_model.predict(X_test)  
  
    accuracy = accuracy_score(y_test, y_pred)  
    precision = precision_score(y_test, y_pred)   
    recall = recall_score(y_test, y_pred) 
    f1 = f1_score(y_test, y_pred)  
  

    print(classification_report(y_test, y_pred))  
    print(f"Accuracy: {accuracy}")  
    print(f"Precision: {precision}")  
    print(f"Recall: {recall}")  
    print(f"F1 Score: {f1}")  
    logging.info(f"Accuracy:{accuracy}")
    logging.info(f"Precision:{precision}")
    logging.info(f"recall:{recall}")
    logging.info(f"f1:{f1}")
  
